# Sample CSV / Excel Templates & Example Error Report

This file contains sample CSV content and guidance for the emissions bulk upload template and an example error-report. Copy the CSV blocks into files under `docs/samples/` (e.g., `emissions_template.csv`, `error_report_example.csv`) or upload an equivalent Excel (`.xlsx`) with the first sheet named `emissions`.

Purpose
- Provide a canonical CSV template for MVP uploads.
- Show example rows and an example error-report format that the backend can produce for partial failures.

Template columns (MVP required): `site_id`, `emission_type`, `value`, `unit`, `timestamp`, `reference_id` (optional)

Sample emissions CSV (save as `docs/samples/emissions_template.csv`)

```csv
site_id,emission_type,value,unit,timestamp,reference_id
c1a2b3d4-0000-4000-8000-000000000001,Scope 1 - Fuel Combustion,123.45,kg,2025-08-01T08:00:00Z,INV-1001
c1a2b3d4-0000-4000-8000-000000000001,Scope 2 - Purchased Electricity,987.00,kg,2025-08-01T08:00:00Z,INV-1002
c1a2b3d4-0000-4000-8000-000000000002,Scope 1 - Fugitive Emissions,0.5,kg,2025-08-02T12:30:00Z,
```

Notes for Excel
- If using `.xlsx`, first sheet should be named `emissions`.
- Keep header row exactly as listed above (case-sensitive mapping by default).
- Optional: provide a mapping_id to use a saved template that maps different column names.

Example error-report CSV (save as `docs/samples/error_report_example.csv`)

Columns in the error report:
- `row_number` — original row number in the uploaded file (1-based, header excluded)
- `site_id`, `emission_type`, `value`, `unit`, `timestamp` — echoed values to help identify the row
- `errors` — semicolon-separated list of validation error messages for the row

```csv
row_number,site_id,emission_type,value,unit,timestamp,errors
2,c1a2b3d4-0000-4000-8000-000000000001,Scope 1 - Fuel Combustion,,-,2025-08-01T08:00:00Z,value missing; unit invalid
4,INVALID-UUID,Scope 2 - Purchased Electricity,500,kg,2025-08-01T08:00:00Z,site_id not a valid UUID
6,c1a2b3d4-0000-4000-8000-000000000003,Scope 1,-100,kg,2025-08-03T09:00:00Z,value must be >= 0
```

Server output options
- The API should return a per-upload result object (see `docs/openapi.yaml`) with `upload_id`, `inserted_count`, `failed_count`, and `error_file_url`.
- The `error_file_url` can point to a CSV or PDF generated by the worker. The CSV format above is recommended for programmatic downloads; PDF may be used for human-friendly reports.

Guidance for implementers
- Use streaming parsing for large files; validate row-by-row and accumulate errors for failed rows.
- On partial success: insert valid rows in batches and produce an error-report file for failed rows; include `inserted_count` and `failed_count` in API response.
- Preserve original row numbers (count header as row 1) so the error report maps cleanly back to the user's file.

Document owner: Engineering
Last updated: 2025-08-18
